machine:
  environment:
    PATH: ${HOME}/nim/bin:${PATH}

dependencies:
    pre:
        - |
            if [ ! -x ${HOME}/nim/bin/nim ]; then
                cd ${HOME}
                wget --quiet http://builds.nim-lang.org/download/nim-0.16.0.tar.xz
                tar xf nim-0.16.0.tar.xz
                mv nim-0.16.0 nim
                cd nim/
                sh build.sh
                nim c koch
                ./koch tools
            fi
    cache_directories:
        - ~/nim/

test:
    pre:
        - nimble install --accept
    override:
        - nimble tests
    post:
        - nimble uninstall commandeer --accept
